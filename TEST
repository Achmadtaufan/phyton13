 IF EXISTS (SELECT PLAN_CODE, PLAN_NAME, [LINI USAHA], [OJK CODE], SYSTEM_UPDATEDATE, USERID FROM RF_OJK_LINIUSAHA A WHERE EXISTS (SELECT       
  PLAN_CODE, PLAN_NAME,[LINI USAHA], [OJK CODE], SYSTEM_UPDATEDATE, USERID FROM STG_RF_OJK_LINIUSAHA B WHERE A.PLAN_CODE=B.PLAN_CODE AND A.[OJK CODE]=B.[OJK CODE]))      
    
  BEGIN    
  UPDATE A    
  SET A.PLAN_NAME = B.PLAN_NAME,  
  A.[LINI USAHA] = B.[LINI USAHA],  
  A.SYSTEM_UPDATEDATE = B.SYSTEM_UPDATEDATE,  
  A.USERID = B.USERID  
  FROM RF_OJK_LINIUSAHA A    
  INNER JOIN STG_RF_OJK_LINIUSAHA B ON A.PLAN_CODE=B.PLAN_CODE AND A.[OJK CODE]=B.[OJK CODE]   
  END  
    
  ELSE  
    
  BEGIN    
  INSERT INTO RF_OJK_LINIUSAHA  (PLAN_CODE,PLAN_NAME,[LINI USAHA],[OJK CODE],SYSTEM_UPDATEDATE,USERID)  
  SELECT A.PLAN_CODE, A.PLAN_NAME, A.[LINI USAHA], A.[OJK CODE], A.SYSTEM_UPDATEDATE, A.USERID FROM STG_RF_OJK_LINIUSAHA A    
  WHERE NOT EXISTS (SELECT PLAN_CODE,[OJK CODE]  FROM RF_OJK_LINIUSAHA B WHERE A.PLAN_CODE=B.PLAN_CODE AND A.[OJK CODE]=B.[OJK CODE])    
  END 
